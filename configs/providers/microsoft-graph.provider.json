{
  "id": "microsoft-graph",
  "label": "Microsoft Graph",
  "version": "1",
  "tenant_mode": "per-tenant",
  "discovery": "https://login.microsoftonline.com/common/v2.0/.well-known/openid-configuration",
  "auth": "https://login.microsoftonline.com/common/oauth2/v2.0/authorize",
  "token": "https://login.microsoftonline.com/common/oauth2/v2.0/token",
  "scopes": [
    "offline_access",
    "User.Read",
    "Mail.Read"
  ],
  "grant_types": [
    "authorization_code",
    "refresh_token",
    "client_credentials"
  ],
  "redirect_uris": [
    "https://localhost:8080/callback",
    "https://oauth-worker.greentic.local/callback"
  ],
  "secrets": {
    "client_id_key": "tenants/{tenant}/oauth/msgraph/client_id",
    "client_secret_key": "tenants/{tenant}/oauth/msgraph/client_secret",
    "extra": {
      "azure_tenant_id_key": "tenants/{tenant}/oauth/msgraph/tenant_id"
    }
  },
  "blueprints": {
    "auth_url_template": "https://login.microsoftonline.com/{tenantId}/oauth2/v2.0/authorize?client_id={client_id}&response_type=code&redirect_uri={redirect_uri}&scope={scopes}&state={state}",
    "scope_presets": {
      "mail-read": [
        "Mail.Read",
        "offline_access"
      ]
    }
  }
}
