{
  "flow_id": "example-flow-id",
  "grant_type": "authorization_code",
  "state": "init",
  "steps": [
    {
      "name": "register-app",
      "description": "Register an OAuth application with the provider and obtain client credentials.",
      "inputs_needed": [],
      "outputs": ["client_id", "client_secret"],
      "automatable": false
    },
    {
      "name": "user-consent",
      "description": "Direct the user to the Greentic broker authorize URL to grant access.",
      "inputs_needed": [
        {
          "key": "client_id",
          "kind": "string",
          "required": false,
          "allowed_values": null,
          "default": "managed-by-greentic"
        },
        {
          "key": "redirect_uri",
          "kind": "url",
          "required": true,
          "allowed_values": null,
          "default": "https://auth.acme.example.com/oauth/callback/acme/microsoft-graph"
        },
        {
          "key": "scopes",
          "kind": "enum",
          "required": true,
          "allowed_values": [
            "offline_access",
            "openid",
            "Calendars.Read",
            "Mail.Send"
          ],
          "default": "offline_access openid Calendars.Read Mail.Send"
        }
      ],
      "outputs": ["authorization_code"],
      "automatable": false
    },
    {
      "name": "exchange-code",
      "description": "The broker exchanges the authorization code for tokens.",
      "inputs_needed": [],
      "outputs": ["access_token", "refresh_token", "expires_in"],
      "automatable": true
    }
  ],
  "next_actions": [
    {
      "rel": "start-authorization",
      "href": "{api_base}/:env/acme/microsoft-graph/start?team=platform",
      "method": "GET",
      "accepts": null,
      "returns": "text/html"
    }
  ],
  "webhooks": null,
  "expires_at": null,
  "auth_url_example": "https://login.microsoftonline.com/{tenantId}/oauth2/v2.0/authorize?client_id={client_id}&response_type=code&redirect_uri=https%3A%2F%2Flocalhost%3A8080%2Fcallback&scope=offline_access%20User.Read%20Mail.Read&state={state}"
}
